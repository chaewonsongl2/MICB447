#HISEAS

#make detached screen of team server
screen -S hiseas_demux

#load qiime2 on detached screen
conda activate qiime2-2021.11

#Import hiseas data using manifest TO /data/hiseas
qiime tools import \
--type 'SampleData[SequencesWithQuality]' \
--input-path /mnt/datasets/project_2/hiseas/hiseas_manifest.txt \
--input-format SingleEndFastqManifestPhred33V2 \
--output-path hiseas_demux.qza

#Visualize demux.qza
qiime demux summarize \
  --i-data hiseas_demux.qza \
  --o-visualization hiseas_demux.qzv

# Determine ASVs with DADA2
qiime dada2 denoise-single \
  --i-demultiplexed-seqs hiseas_demux.qza \
  --p-trim-left 0 \
  --p-trunc-len 293 \
  --o-representative-sequences hiseas_rep-seqs.qza \
  --o-table hiseas_table.qza \
  --o-denoising-stats hiseas_stats.qza

# Visualize DADA2 stats
qiime metadata tabulate \
  --m-input-file hiseas_stats.qza \
  --o-visualization hiseas_stats.qzv

# Visualize ASVs stats
qiime feature-table summarize \
  --i-table hiseas_table.qza \
  --o-visualization hiseas_table.qzv \
  --m-sample-metadata-file /mnt/datasets/project_2/hiseas/sample-metadata.tsv
  
qiime feature-table tabulate-seqs \
  --i-data hiseas_rep-seqs.qza \
  --o-visualization hiseas_rep-seqs.qzv
